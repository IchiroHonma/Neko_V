'Private Sub CommandButton1_Click()
 '   Debug.Print " ObjPtr of Me: " & Hex(ObjPtr(Me))
'End Sub

'Private Sub CommandButton2_Click()
   ' Controls.Clear
'End Sub

Private Sub UserForm_Click()
    Static count_01 As Integer
    

    'いまの状況でこれ推し続けるとコントロールが無限に作られる
    Dim myCmdBtn As MSForms.CommandButton
    Dim myCmdBtn2 As MSForms.CommandButton
    
    'Set myCmdBtn = Me.Controls.Add("Forms.CommandButton.1", "CommandButton" & fCol.Count + 1, True)
    Static int_02 As Integer
    'int_02 = 0 (0に戻される)
    Set myCmdBtn = Me.Controls.Add("Forms.CommandButton.1", "CommandButton あ", True)
    Set myCmdBtn2 = Me.Controls.Add("Forms.CommandButton.1", "CommandButton い" & int_02, True)
    int_02 = int_02 + 1
    Controls.Add ("forms.commandbutton.1")
    Dim i As Integer
    i = Controls.Count - 1
    Debug.Print "現在コントロール数は" & Controls.Count & ", 最大のコントロールは " & Controls(i).Name
    Dim ctr As Control
    For Each ctr In Controls
    Debug.Print "コントロールカウント" & count_01 & "回目 " & ctr.Name & ", インデックス番号は" '& ctr.Index
    Next ctr
    'Set myCmdBtn2 = Controls(1)
    
    '答え
    'http://akashi-keirin.hatenablog.com/entry/2017/09/23/212455
    'Addメソッドの第１引数に、コマンドボタンのクラス変数「Forms.CommandButton.1」を指定。
    '最後の「1」まで必要なので注意。最初、オブジェクトの通し番号だと思って & i とするとバグる
    'つまりオブジェクトの番号じゃなくて
    'Forms.CommandButton.1 がクラス名
    'MSForms.CommandButton は型名
    'なんで違うんだよう
    
    'この i は多分インデックスの登録番号なんだと思う
    '→違う、なぜなら、この場合 index 番号は0 だから
    '今この状況でこれを2にしたらおかしくなる
    With myCmdBtn
        .Name = "名前だよ"                      '名前は何処で使われる名前だろうか
        .Caption = "キャプションだよ"    '表面に表現されるのが caption
        '.Top = Controls("Commandbutton" & 1).Height 'commandbuttonの高さ (絶対値、今の位置じゃない)
        '.Left = Controls("commandbutton" & 1).Width
        .Top = 1
        .Left = 1
    End With
    Debug.Print "Controlsの数は" & Controls.Count
    'Debug.Print Controls(1).Name
    Debug.Print Controls(0).Name
    Debug.Print Controls(1).Name
    'これで判るけど、 controlsは0から始まる…
    'UserFormsはカウントなし
    'WorkSheets系は 1からカウントする
    'Controlsは0から
    Debug.Print UserForms.Count
    MsgBox "でもって"
    With myCmdBtn2
        .Caption = "いか"
        '.Object.Caption "だぜ"
    End With
    'myCmdBtn2.
    Dim int_01 As Integer
    int_01 = Application.InputBox("入力？", Type:=1)
    If int_01 = 1 Then
        MsgBox TypeName(int01)
        Controls.Clear
    Else
        MsgBox "続けよ" & TypeName(int_01)
    End If
    
    If Not int_01 = 1 Then
    'If Not Controls Is Nothing Then
    With Controls(1)
    Select Case int_01
        Case 1
        MsgBox "終了だ"
        Case 2
        End
        Case 3
        MsgBox "Top is " & .Top & vbCrLf & _
                ", left is " & .Left & vbCrLf & _
                ", heightt is " & .Height & vbCrLf & _
                ", width is " & .Width
        
        Case Else
        Debug.Print "まだまだ"
    End Select
    End With
    Else
    End If
    
    
    i = Controls.Count
    Debug.Print i
    If i >= 2 Then
    With Controls(i - 1)
        .Top = Controls(i - 2).Top + Controls(i - 2).Height
        .Left = Controls(i - 2).Top + Controls(i - 2).Width
    End With
    Else
    End If
    Debug.Print "テストです" & vbCrLf & _
                "aa" & Controls("CommandButton" & count_01 + 1).Name
    'Debug.Print Me.Controls("CommandButton" & count_01 + 1).CodeName
    'Debug.Print Me.Controls("CommandButton" & count_01 + 1).Index
    Debug.Print "Controlsは0から？1から？ " & Controls(0).Name & ", 結果的には0からのようです"
    
    count_01 = count_01 + 1
    
    
    '(1) 静的コントロールがあると Controls.Clearが出来ない
    '(2) Staticは 0スタート
    '(3) 名前は重複できる
    '(4) 各コントロールは"名前" or "インデックス"でのみ参照できる
    '(5) Controlsは"オブジェクト名"ない→.CodeNameないです
    '(6) Controlsは.indexもないです。
    '(7) だから結局 Controlsは組み込み配列ではなく、疑似（ある程度似たことができる）配列なんだなと
    Debug.Print "ここで終了" & count_01 & vbCrLf & vbCrLf
    
    
    
    
    
    
    'clearしないと、開放されない
End Sub


Private Sub UserForm_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    Controls.Clear
End Sub


[動的]
Option Explicit
Dim fCol As Collection

'dim fCls as

'基礎事項
'(1) コントロールオブジェクト型は
'   MSForms.コントロールオブジェクト

'(2) コントロールインスタンスの Controlsメソッドからの参照は
'   フォームインスタンス.Controls.Item("コントロール名.1")
'   フォームインスタンス.Controls.Item("コントロール名" & i)    iを変数にする場合の参照

'(3) Controlsへの動的（メモリ上への）追加は

'   Function Add(bstrProgID As String, [Name], [Visible]) As Control
'    Member of MSForms.Controls
'   [1] bstrProgID とは 登録名？
'   この登録名は
'   [Forms.コントロールオブジェクト名.#] で表現される必要がある
'   だから
'   ["Forms.コントロールオブジェクト名." & i]でも大丈夫
'
'   名前は namae


Private Sub CommandButton1_Click()
    Dim myCmdBtn As MSForms.CommandButton
    'Set myCmdBtn = Me.Controls.Add("Forms.CommandButton.1", "CommandButton" & fCol.Count + 1, True)
    Set myCmdBtn = Me.Controls.Add("Forms.CommandButton.1", "CommandButton")
    'この i は多分インデックスの登録番号なんだと思う
    '今この状況でこれを2にしたらおかしくなる
    With myCmdBtn
        .Name = "名前だよ"                      '名前は何処で使われる名前だろうか
        '.Object.Caption = "キャプションだよ"    '表面に表現されるのが caption
        .Caption = "どうや"
        .Top = Controls("Commandbutton" & 1).Height 'commandbuttonの高さ (絶対値、今の位置じゃない)
        .Left = Controls("commandbutton" & 1).Width
    End With
    Debug.Print "Controlsの数は" & Controls.Count
    Debug.Print Controls(1).Name
    Debug.Print Controls(0).Name
    'これで判るけど、 controlsは0から始まる…
    'UserFormsはカウントなし
    'WorkSheets系は 1からカウントする
    'Controlsは0から
    Debug.Print UserForms.Count
    

End Sub

Private Sub UserForm_Click()

End Sub
